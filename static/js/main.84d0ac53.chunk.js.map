{"version":3,"sources":["utils/componentColorer.js","components/AdjustedData.js","components/DataTable.js","utils/mathHelper.js","components/ScatterPlot.js","components/PrincipalComponentChart.js","App.js","index.js"],"names":["componentColorer","n","AdjustedData","data","principalComponents","setHighlightedComponent","highlightedIndex","setHighlightedIndex","svgRef","useRef","useEffect","adjustedData","svg","select","current","PCA","computeAdjustedData","Number","exception","console","error","min","Math","max","xScale","scaleLinear","domain","range","nice","clamp","xAxis","axisBottom","style","transition","call","selectAll","join","attr","_value","index","value","on","headerStyle","textDecoration","textDecorationColor","textDecorationThickness","onMouseEnter","onMouseLeave","ref","height","className","DataTable","setData","handleDelete","event","preventDefault","filter","_v","i","deleteButtonStyle","border","color","cursor","display","margin","padding","id","sort","map","key","parseFloat","toFixed","onClick","onSubmit","x","target","y","concat","name","width","a","b","px","py","gradient","c","gradient1","c1","gradient2","c2","ScatterPlot","highlightedComponent","domainMin","domainMax","length","yScale","yAxis","axisRight","componentGradientFunction","mathHelper","vector","intersections","residueGradientFunction","duration","remove","stopPropagation","newData","slice","splice","mousePosition","mouse","newDataPoint","invert","component","viewBox","PrincipalComponentChart","eigenvalues","eigenvalue","maxY","scaleBand","ticks","bandwidth","App","useState","setPrincipalComponents","vectors","getEigenVectors","Fragment","random","computeDeviationMatrix","disabled","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.84d0ac53.chunk.js","sourcesContent":["const componentColorer = (n) => {\n  switch (n) {\n  case 0:\n    return '#ff9e1b'\n  case 1:\n    return '#c4d52a'\n  case 2:\n    return '#7c8034'\n  default:\n    return '#cccccc'\n  }\n}\n\nexport default componentColorer\n","import React, { useEffect, useRef } from 'react'\nimport { axisBottom, scaleLinear, select } from 'd3'\nimport PCA from 'pca-js'\nimport componentColorer from '../utils/componentColorer'\n\nconst AdjustedData = ({ data, principalComponents, setHighlightedComponent, highlightedIndex, setHighlightedIndex, n }) => {\n  const svgRef = useRef()\n\n  useEffect(() => {\n    const svg = select(svgRef.current)\n\n    let adjustedData\n    try {\n      adjustedData = PCA.computeAdjustedData(data, principalComponents[Number(n) - 1]).adjustedData[0]\n    } catch (exception) {\n      console.error('Handled exception in 3rd party library')\n      return\n    }\n\n    // global minimum and maxium for all components\n    const min = Math.min(...PCA.computeAdjustedData(data, principalComponents[0]).adjustedData[0], ...PCA.computeAdjustedData(data, principalComponents[1]).adjustedData[0])\n    const max = Math.max(...PCA.computeAdjustedData(data, principalComponents[0]).adjustedData[0], ...PCA.computeAdjustedData(data, principalComponents[1]).adjustedData[0])\n\n    // create scales that map our data to the fixed size screen space\n    const xScale = scaleLinear()\n      .domain([min, max])\n      .range([0, 300])\n      .nice()\n      .clamp(true)\n\n    // draw X axis\n    const xAxis = axisBottom(xScale)\n    svg\n      .select('.x-axis')\n      .style('transform', 'translateY(25px)')\n      .transition()\n      .call(xAxis)\n\n    // draw data points\n    svg\n      .selectAll('.dataPoint')\n      .data(adjustedData)\n      .join('circle')\n      .attr('class', 'dataPoint')\n      .attr('r', (_value, index) => index === highlightedIndex ? 5 : 3)\n      .attr('cy', 25)\n      .style('fill', (_value, index) => index === highlightedIndex ? 'red' : 'black')\n      .transition()\n      .attr('cx', value => xScale(value))\n\n    // set highlighting on mouse over\n    svg\n      .selectAll('.dataPoint')\n      .on('mouseenter', (_value, index) => {\n        setHighlightedIndex(index)\n      })\n      .on('mouseleave', () => {\n        setHighlightedIndex(null)\n      })\n  }, [data, principalComponents, n, highlightedIndex, setHighlightedIndex])\n\n  const headerStyle = {\n    textDecoration: 'underline',\n    textDecorationColor: componentColorer(Number(n - 1)),\n    textDecorationThickness: '.15em'\n  }\n\n  return (\n    <div\n      onMouseEnter={() => setHighlightedComponent(n)}\n      onMouseLeave={() => setHighlightedComponent(null)}\n    >\n      <h3 style={headerStyle}>Component {n}</h3>\n      <svg ref={svgRef} height=\"60\">\n        <g className=\"x-axis\" />\n      </svg>\n    </div>\n  )\n}\n\nexport default AdjustedData\n","import React from 'react'\n\nconst DataTable = ({ data, setData, highlightedIndex, setHighlightedIndex }) => {\n  const handleDelete = (index) => {\n    return (event) => {\n      event.preventDefault()\n      setData(data.filter((_v, i) => index !== i))\n    }\n  }\n\n  const addDataPoint = (event) => {\n    event.preventDefault()\n    const x = Number(event.target.x.value)\n    const y = Number(event.target.y.value)\n    setData(data.concat([[x, y]]))\n\n    event.target.x.value = ''\n    event.target.y.value = ''\n  }\n\n  const deleteButtonStyle = {\n    border: 'none',\n    color: 'darkblue',\n    cursor: 'pointer',\n    display: 'inline',\n    margin: 0,\n    padding: 0,\n  }\n\n  return (\n    <div id=\"dataTable\">\n      <h3>Data</h3>\n      <table>\n        <tbody>\n          <tr>\n            <th>X</th>\n            <th>Y</th>\n          </tr>\n          {data.sort().map((value, index) =>\n            <tr\n              key={index}\n              style={index === highlightedIndex ? { color: 'red' } : {}}\n              onMouseEnter={() => setHighlightedIndex(index)}\n              onMouseLeave={() => setHighlightedIndex(null)}\n            >\n              <td>{Number.parseFloat(value[0]).toFixed(2)}</td>\n              <td>{Number.parseFloat(value[1]).toFixed(2)}</td>\n              <td><button style={deleteButtonStyle} onClick={handleDelete(index)}>[X]</button></td>\n            </tr>\n          )}\n        </tbody>\n      </table>\n      <br />\n      <b>Add data point</b>\n      <form onSubmit={addDataPoint}>\n        X: <input name=\"x\" style={{ width: '25px' }}/><br />\n        Y: <input name=\"y\" style={{ width: '25px' }}/><br />\n        <button style={{ width: '75px' }}>Add</button>\n      </form>\n    </div>\n  )\n\n}\n\nexport default DataTable\n","// converts vector (a,b) with point (px,py) into a Steigungsfunktion\nconst vectorToGradientFunction = (a, b, px, py) => {\n  const gradient = b / a\n  const c = py - gradient * px\n  return { gradient, c }\n}\n\nconst lineIntersection = (gradient1, c1, gradient2, c2) => {\n  const a = gradient1\n  const b = gradient2\n  const c = c1\n  const d = c2\n  return [\n    (d - c) / (a - b),\n    a * ((d - c) / (a - b)) + c,\n  ]\n}\n\nexport default {\n  vectorToGradientFunction,\n  lineIntersection,\n}\n","import React, { useEffect, useRef } from 'react'\nimport { axisBottom, axisRight, event, mouse, scaleLinear, select } from 'd3'\nimport componentColorer from '../utils/componentColorer'\nimport mathHelper from '../utils/mathHelper'\n\nconst ScatterPlot = ({ data, setData, principalComponents, highlightedComponent, highlightedIndex, setHighlightedIndex }) => {\n  const svgRef = useRef()\n\n  // this executes on page load and every time the data changes\n  useEffect(() => {\n    const svg = select(svgRef.current)\n\n    let domainMin = -5\n    let domainMax = 5\n    if (data.length > 0) {\n      domainMin = Math.min(...data.map(value => value[0]), ...data.map(value => value[1])) - 5\n      domainMax = Math.max(...data.map(value => value[0]), ...data.map(value => value[1])) + 5\n    }\n\n    // create scales that map our data to the fixed size screen space\n    const xScale = scaleLinear()\n      .domain([domainMin, domainMax])\n      .range([0, 600])\n      .nice()\n\n    const yScale = scaleLinear()\n      .domain([domainMin, domainMax])\n      .range([0, 600])\n      .nice()\n\n    // draw X and Y axis\n    const xAxis = axisBottom(xScale)\n    svg\n      .select('.x-axis')\n      .style('transform', 'translateY(600px)')\n      .transition()\n      .call(xAxis)\n\n    const yAxis = axisRight(yScale)\n    svg\n      .select('.y-axis')\n      .style('transform', 'translateX(600px)')\n      .transition()\n      .call(yAxis)\n\n    // residues\n    if (highlightedComponent && principalComponents[1] && data.length > 1) {\n      const n = highlightedComponent - 1\n      const componentGradientFunction = mathHelper.vectorToGradientFunction(\n        principalComponents[n].vector[0],\n        principalComponents[n].vector[1],\n        0,\n        0,\n      )\n      // calculate intersections between residues and the principal component\n      const intersections = data.map(value => {\n        const residueGradientFunction = mathHelper.vectorToGradientFunction(\n          principalComponents[n].vector[0],\n          principalComponents[n].vector[1],\n          value[0],\n          value[1],\n        )\n        return mathHelper.lineIntersection(\n          -1 / componentGradientFunction.gradient, // orthogonal from gradient\n          componentGradientFunction.c,\n          residueGradientFunction.gradient,\n          residueGradientFunction.c,\n        )\n      })\n\n      // draw residues\n      svg\n        .selectAll('.residue')\n        .data(data)\n        .join('line')\n        .attr('class', 'residue')\n        .attr('stroke-width', 1)\n        .attr('stroke', 'red')\n        .attr('x1', value => xScale(value[0]))\n        .attr('y1', value => yScale(value[1]))\n        .attr('x2', (_value, index) => xScale(intersections[index][0]))\n        .attr('y2', (_value, index) => yScale(intersections[index][1]))\n        .transition()\n        .duration(500)\n        .attr('opacity', 1)\n    } else {\n      svg\n        .selectAll('.residue')\n        .remove()\n    }\n\n    // draw data points\n    svg\n      .select('.data-points')\n      .selectAll('.dataPoint')\n      .data(data)\n      .join('circle')\n      .attr('class', 'dataPoint')\n      .attr('r', (_value, index) => index === highlightedIndex ? 5 : 3)\n      .style('fill', (_value, index) => index === highlightedIndex ? 'red' : 'black')\n      .transition()\n      .attr('cx', value => xScale(value[0]))\n      .attr('cy', value => yScale(value[1]))\n\n    // data points are deleted on click\n    svg\n      .select('.data-points')\n      .selectAll('.dataPoint')\n      .on('click', (_value, index) => {\n        event.stopPropagation() // prevents that the same click also adds a data point\n        const newData = data.slice()\n        newData.splice(index, 1)\n        setData(newData)\n      })\n\n    // add data point on click\n    svg.on('click', () => {\n      const mousePosition = mouse(svgRef.current)\n      const newDataPoint = [\n        xScale.invert(mousePosition[0]),\n        yScale.invert(mousePosition[1]),\n      ]\n      setData(data.concat([newDataPoint]))\n    })\n\n    // set highlighting on mouse over\n    svg\n      .select('.data-points')\n      .selectAll('.dataPoint')\n      .on('mouseenter', (_value, index) => {\n        setHighlightedIndex(index)\n      })\n      .on('mouseleave', () => {\n        setHighlightedIndex(null)\n      })\n\n    // draw principal component vectors\n    svg\n      .select('.principal-components')\n      .selectAll('.component')\n      .data(principalComponents)\n      .join('line')\n      .attr('class', 'component')\n      .attr('clip-path', 'url(#rect-clip)')\n      .attr('stroke-width', 2)\n      .attr('stroke', (_value, index) => componentColorer(index))\n      .transition()\n      .attr('x1', component => xScale(2 * domainMin * component.vector[0]))\n      .attr('y1', component => yScale(2 * domainMin * component.vector[1]))\n      .attr('x2', component => xScale(2 * domainMax * component.vector[0]))\n      .attr('y2', component => yScale(2 * domainMax * component.vector[1]))\n  }, [data, setData, principalComponents, highlightedComponent, setHighlightedIndex, highlightedIndex])\n\n  return (\n    <div id=\"scatterPlot\">\n      <h3>Scatter Plot</h3>\n      <svg ref={svgRef} width=\"600\" height=\"600\" viewBox=\"0 0 600 600\">\n        <clipPath id=\"rect-clip\">\n          <rect x=\"0\" y=\"0\" width=\"600\" height=\"600\" />\n        </clipPath>\n        <g className=\"x-axis\" />\n        <g className=\"y-axis\" />\n        <g className=\"principal-components\" />\n        <g className=\"data-points\" />\n      </svg>\n    </div>\n  )\n}\n\nexport default ScatterPlot\n","import React, { useEffect, useRef } from 'react'\nimport { axisBottom, axisRight, scaleBand, scaleLinear, select } from 'd3'\nimport componentColorer from '../utils/componentColorer'\n\nconst PrincipalComponentChart = ({ principalComponents }) => {\n  const svgRef = useRef()\n\n  const eigenvalues = principalComponents.map(vector => vector.eigenvalue)\n\n  useEffect(() => {\n    const svg = select(svgRef.current)\n\n    const maxY = Math.max(...eigenvalues)\n\n    // create scales\n    const xScale = scaleBand()\n      .domain(eigenvalues.map((value, index) => index))\n      .range([0, 300])\n      .padding(0.5)\n\n    const yScale = scaleLinear()\n      .domain([0, maxY])\n      .range([150, 0])\n\n    // draw Y axis and bar numbers\n    const xAxis = axisBottom(xScale).ticks(eigenvalues.length)\n    svg\n      .select('.x-axis')\n      .style('transform', 'translateY(150px)')\n      .call(xAxis)\n\n    const yAxis = axisRight(yScale)\n    svg\n      .select('.y-axis')\n      .style('transform', 'translateX(300px)')\n      .transition()\n      .call(yAxis)\n\n    // draw bars\n    svg\n      .selectAll('.bar')\n      .data(eigenvalues)\n      .join('rect')\n      .attr('class', 'bar')\n      .style('transform', 'scale(1, -1)')\n      .attr('x', (value, index) => xScale(index))\n      .attr('y', -150)\n      .attr('width', xScale.bandwidth())\n      .transition()\n      .attr('height', value => 150 - yScale(value))\n      .style('fill', (_value, index) => componentColorer(index))\n  }, [principalComponents, eigenvalues])\n\n  return (\n    <div id=\"principalComponents\">\n      <h3>Principal Components</h3>\n      <svg ref={svgRef}>\n        <g className=\"x-axis\" />\n        <g className=\"y-axis\" />\n      </svg>\n    </div>\n  )\n}\n\nexport default PrincipalComponentChart\n","import React, { useEffect, useState } from 'react'\nimport './App.css'\nimport PCA from 'pca-js'\nimport AdjustedData from './components/AdjustedData'\nimport DataTable from './components/DataTable'\nimport ScatterPlot from './components/ScatterPlot'\nimport PrincipalComponentsChart from './components/PrincipalComponentChart'\n\nfunction App () {\n  const [data, setData] = useState([[0, 0]])\n  const [highlightedComponent, setHighlightedComponent] = useState(null)\n  const [highlightedIndex, setHighlightedIndex] = useState(null)\n  const [principalComponents, setPrincipalComponents] = useState([])\n\n  const generateRandomScatterPlot = () => {\n    let newData = []\n    for (let i = 0; i < 20; i++) {\n      newData = newData.concat([[\n        Math.random() * 200 - 100,\n        Math.random() * 200 - 100,\n      ]])\n    }\n    setData(newData)\n  }\n\n  useEffect(() => {\n    if (data.length === 0) {\n      setPrincipalComponents([])\n      return\n    }\n    const vectors = PCA.getEigenVectors(data)\n    setPrincipalComponents(vectors)\n  }, [data])\n\n  return (\n    <React.Fragment>\n      <div id=\"header\">\n        <h1>Webtools für die Lehre</h1>\n        <h2>Principal Component Analysis (PCA)</h2>\n      </div>\n      <div id=\"buttons\">\n        <h3>Menu</h3>\n        <button onClick={generateRandomScatterPlot}>Generate random data</button>\n        <br />\n        <button onClick={() => setData([])}>Clear data</button><br />\n        {data.length > 0 ?\n          <button onClick={() => setData(PCA.computeDeviationMatrix(data))}>Center Data</button> :\n          <button disabled>Center Data</button>\n        }\n      </div>\n      <ScatterPlot\n        data={data}\n        setData={setData}\n        principalComponents={principalComponents}\n        highlightedComponent={highlightedComponent}\n        highlightedIndex={highlightedIndex}\n        setHighlightedIndex={setHighlightedIndex}\n      />\n      <PrincipalComponentsChart principalComponents={principalComponents} />\n      <div id=\"singleComponents\">\n        <AdjustedData\n          data={data}\n          principalComponents={principalComponents}\n          setHighlightedComponent={setHighlightedComponent}\n          highlightedIndex={highlightedIndex}\n          setHighlightedIndex={setHighlightedIndex}\n          n=\"1\"\n        />\n        <AdjustedData\n          data={data}\n          principalComponents={principalComponents}\n          setHighlightedComponent={setHighlightedComponent}\n          highlightedIndex={highlightedIndex}\n          setHighlightedIndex={setHighlightedIndex}\n          n=\"2\"\n        />\n      </div>\n      <DataTable\n        data={data}\n        setData={setData}\n        highlightedIndex={highlightedIndex}\n        setHighlightedIndex={setHighlightedIndex}\n      />\n    </React.Fragment>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n"],"sourceRoot":""}